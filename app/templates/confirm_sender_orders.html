{% extends "base.html" %}
{% block content %}
<div><a href="/">Main page</a></div>
<div class="btn btn-info" id="get-sender-orders">Get Orders</div>
<div id="orders-list"></div>
<script>
    $(document).ready(function(){
        $('#get-sender-orders').click(function(){
            $.ajax({
                  url: "/getSenderOrders",
                  data: {'real': 1},
                  success: function( response ) {
                      var result = $.parseJSON(response)
                        console.debug('Result', result);
                      if(result.status == 'error'){
                        alert (JSON.stringify(result));
                        return;
                      }
                      var ordersList = $("#orders-list");
                      $.each(result.data.orders, function(key, value){

                          var orderItemElem = $('<div>', {
                               class: 'order-item',
                               id: value.order_id + '-' + value.num
                          });

                          var deliveryName = value.delivery.unique_name ? value.delivery.unique_name : "не определена";

                          $('<input/>', {
                            type: 'checkbox',
                            name: 'order',
                            value: value.order_id
                          }).appendTo(orderItemElem);

                          $('<label>', {
                            for: 'order'
                          }).text(value.order_id + '-' + value.num + ', служба ' + deliveryName ).appendTo(orderItemElem);

                          $('<a>', {
                            class: 'label-link',
                            id: value.order_id,
                            href: '/getSenderOrderLabel?order_id=' + value.order_id,
                          }).text(' Получить ярлык ').appendTo(orderItemElem);

                          orderItemElem.appendTo('#orders-list');

                      })

                  }
                });
        });
    });
</script>
{% endblock %}